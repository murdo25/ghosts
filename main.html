<html>
<link rel="shortcut icon" href="">

<style type="text/css">
    body {
        background-color: black
    }
</style>

<head>

    <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">


    <script type="text/javascript">
        //main state map
        var keyState = {};

        var x = "Total Width: " + screen.width
        var y = "Total Height: " + screen.height
        var currentAnimation = "idle"

        //consumables
        var burgerKING = 0
        var theBurgerKING = ""
        var burger_on_map = true
        var won = false



        function consume(item, character, left, top) {
            switch (item) {
                case "burger":
                    if (burger_on_map == false) {
                        break
                    }
                    let burgered = checkRadius(top, left, 15, 400, 105)
                    if (burgered) {
                        burgerKING = 140
                        theBurgerKING = character
                        removeElement("burger")
                        burger_on_map = false

                    }
                    break

                case "ghost":
                    if (won) {
                        break
                    }

                    let ghost_element = document.getElementById("ghost")
                    let ghost_x = parseInt(ghost_element.style.left)
                    let ghost_y = parseInt(ghost_element.style.top)
                    //console.log("ghost x,y", ghost_x, ghost_y)
                    let got_the_ghost = checkRadius(left, top, ghost_x, ghost_y, 25)
                    if (got_the_ghost) {
                        won = true
                        removeElement("ghost")
                        alert("The Ghost Hunter Wins!")
                    }
                    break

                case "win":
                    if (won) {
                        break
                    }
                    let win = checkRadius(left, top, 400, 300, 17)
                    if (win) {
                        won = true

                        removeElement("winningSquash")
                        alert("The Ghost Wins!")

                    }
                    break

            }
        }

        function checkRadius(x, y, starting_x, starting_y, radius) {
            x = parseInt(x)
            y = parseInt(y)

            let distence_from_centroid = Math.sqrt(Math.pow(x - starting_x, 2) + Math.pow(y - starting_y, 2))

            console.log("dist", distence_from_centroid, "radius", radius, "hunterx", x, "huntery", y, "targetx", starting_x, "targety", starting_y)

            if (radius < distence_from_centroid) {
                return false
            }
            else {
                return true
            }
        }

        function removeElement(elementId) {
            // Removes an element from the document
            var element = document.getElementById(elementId);
            if (element != null) {
                element.parentNode.removeChild(element)
            }

            console.log('removed')

        }

        function keyPress(movement) {

            let character = document.getElementById(movement[1])

            //if the dude is running
            if (movement[1] == "hunter") {
                if (currentAnimation != "dash") {
                    document.getElementById(movement[1]).src = "animations/west_dash_animation_by_hero_in_pixels.gif"
                    currentAnimation = "dash"
                }

            }

            let moveAmmount = 3

            if (burgerKING > 0 && character == theBurgerKING) {
                moveAmmount = 5
                burgerKING -= 1
            }


            switch (movement[0]) {
                case "up":
                    character.style.top = parseInt(character.style.top) - moveAmmount + 'px';
                    break
                case "down":
                    character.style.top = parseInt(character.style.top) + moveAmmount + 'px';
                    break
                case "left":
                    character.style.left = parseInt(character.style.left) - moveAmmount + 'px';
                    character.style.transform = "scaleX(-1)"
                    character.style.webkitTransform = "scaleX(-1)"
                    break
                case "right":
                    character.style.left = parseInt(character.style.left) + moveAmmount + 'px';
                    character.style.transform = "scaleX(1)"
                    character.style.webkitTransform = "scaleX(1)"
                    break
            }

            //consumables
            //Burger
            if (movement[1] == "ghost") {
                consume("burger", character, character.style.left, character.style.top)
                consume("win", character, character.style.left, character.style.top)
            }
            if (movement[1] == "hunter") {
                //consume("win", character, character.style.top, character.style.left)
                consume("ghost", character, character.style.left, character.style.top)
            }
            //console.log("moving", character.style.top, character.style.left)
        }





        window.addEventListener('keydown', function(e) {
            keyState[e.keyCode || e.which] = true;
        }, true);

        window.addEventListener('keyup', function(e) {
            keyState[e.keyCode || e.which] = false;
            if (e.keyCode > 40) {
                if (currentAnimation == "dash") {
                    currentAnimation = "idle"
                    document.getElementById("hunter").src = "animations/west_idle_animation_by_hero_in_pixels.gif"
                }
            }
        }, true);

        function gameLoop() {
            //console.log(keyState)
            if (keyState[37]) {
                keyPress(["left", "ghost"])
            }
            if (keyState[39]) {
                keyPress(["right", "ghost"])
            }
            if (keyState[38]) {
                keyPress(["up", "ghost"])
            }
            if (keyState[40]) {
                keyPress(["down", "ghost"])
            }
            if (keyState[65]) {
                keyPress(["left", "hunter"])
            }
            if (keyState[68]) {
                keyPress(["right", "hunter"])
            }
            if (keyState[87]) {
                keyPress(["up", "hunter"])
            }
            if (keyState[83]) {
                keyPress(["down", "hunter"])
            }

            setTimeout(gameLoop, 10);
        }


        gameLoop()
    </script>
</head>

<body>

    <img style="position:absolute;left:0; top:0;" id="ghost" src="animations/ghost.gif" height="50px">
    <img style="position:absolute;left:200; top:200;" id="hunter" src="animations/west_idle_animation_by_hero_in_pixels.gif" height="70px">
    <img style="position:absolute;left:400; top:100;" id="burger" src="animations/princessBurger.jpg" height="70px">
    <img style="position:absolute;left:400; top:300;" id="winningSquash" src="animations/squash.gif" height="70px">


</body>


</html>
